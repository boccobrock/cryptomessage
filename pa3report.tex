\documentclass[letterpaper,12pt]{article} \usepackage{fullpage}
\usepackage{setspace}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{float}
\doublespacing
\begin{document}
\begin{flushleft}
Jeffrey Brock\\
{\today}\\
\end{flushleft}
\begin{center}
\large\textbf{PA 3 - Report Document}
\end{center}
\begin{itemize}

    \item Design: My design has followed my design document almost completely. One of the main changes I made was the need to send a hash of the public key of bob signed by the c private key, instead of sending the actual entire public key. This was because ruby only allows usage of the pem format of the key, and I was forced to either send a hash or send the public key in multiple pieces. I chose to send a signed hash because that is closer to real life certificates. Otherwise I kept the design the same, the protocol follows the diagram given.

    \item Testing: I tested each component in a chronological fashion as they were implemented. I focused first on sending a plain string over a socket, then I tested signing bob's public key hash with the c private key. For this and other tests it was important to write a good formatted hex output of the encrypted result. I then tested encrypting and decrypting with a private or a public key. Then I tested the main protocol, printing out the hex values for all parts of the message on both alice and bobs side. Getting the exact same output from each encrypt/decrypt operation on alice and bobs output showed that it was working properly. Testing with different private/public key pairs also showed that I was properly using the keys.
    
    \item Output: Alice:
        {\footnotesize
            \singlespacing
            \begin{verbatim}
Alice: connecting to localhost on port 12345
Alice: sending HELLO
Alice: bobs encrypted key: 
8c ba 80 39 ff fb 40 62 8b ae 4e f5 39 cd 4b 2b 42 72 4b 8e d6 
a2 b0 71 e4 96 2d 6d 2e c1 a1 5d d4 71 b1 2d 55 69 3e 97 98 f1 
a0 4c cd c7 9e 41 d6 c3 c2 ee 9a ca 66 47 9a a6 cc a3 98 7e a9 
26 1b 40 69 cb cd d2 12 36 57 c4 31 98 35 f8 b0 37 32 ab 4d a3 
0c c5 8c 9a d1 06 e6 29 09 d7 a5 c8 ec 16 36 f0 6f 17 6c 1e 5e 
df 70 aa ed 61 18 b6 0e b9 32 ae c1 5f 62 2b df 26 b6 b0 bc 87 
1f f4 0a

Alice: reading c public key and decrypting bob public key hash
Alice: c public key: 
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDEBEHn/Rbo5AdxmasncnGTDiXo
ZQfLvBHZqLdlvyebPWoAQCywVpFV6jNQWMqqcTa1s8753ruiv1KDLvtOhG1Kl8cb
NcaxHAsXi+jZ0noBX8BSfWtx1zhpRNp3SgCd98QjvLYLXvb854ZYXx+ZQVgfCodA
4CbjXBGdqmIY3BPTlQIDAQAB
-----END PUBLIC KEY-----

Alice: recieved hash: 
GKEGNFWQFN6PDQEIRoyQ9t926Y8=
Alice: computed hash: 
GKEGNFWQFN6PDQEIRoyQ9t926Y8=
Alice: Hashes did match

Alice: message to be sent: 
This is a test message! Edit message.txt to change me.

Alice: SHA1 hash of message: 
70 65 30 34 51 32 74 4f 36 65 72 53 4b 45 73 71 70 4d 77 30 46 
41 6f 6b 36 5a 34 3d

Alice: encrypted hash: 
2c 6a 3b 0d f6 a5 c7 28 05 36 a1 57 09 32 96 df 5d fe 63 e3 9f 
44 f1 99 32 6a e5 d4 7c 33 a6 09 04 d3 70 32 2a 99 fb dd 48 27 
3e f0 55 00 3a ba aa ef 0c 33 ab 9d f7 ea e7 d7 5c 5c a4 c6 a4 
6f 05 93 27 f9 da 4d 6f 89 cc 33 a1 b0 52 38 cd 8e 60 33 1b 87 
10 7d c7 3a eb 7b 47 35 84 7a e4 78 c3 20 d5 0c 75 85 71 90 ed 
b1 3a 28 ab e0 97 c3 cc 81 c7 3f e3 77 a4 71 66 a8 35 64 17 98 
6a d5

Alice: symmetric key: 
bf 79 82 eb 9a 6a de 7d d0 ff 68 07 62 0b 20 55 90 77 12 fb ea 
41 5e 48

Alice: encrypted message: 
16 93 c4 b2 de bc f3 43 ea 11 af 0a bc e3 27 eb 2f 9a 03 31 83 
88 f0 95 ad 19 49 c9 17 c0 ea 3b 26 a6 51 59 65 39 04 2c fa d6 
6e 97 56 49 b5 0b 82 5b 23 d4 53 fe eb 62 b5 59 23 9c 34 29 55 
27 14 9e f4 03 c2 67 a1 ae 49 f8 79 53 8b 98 27 9a e8 40 cb 6f 
d4 cf d6 cc 42 73 52 fb 92 86 f1 52 50 8e a3 93 6f 92 5c b4 99 
5b 48 15 e3 5d 0d 3b bf 1e da 37 b2 eb e5 7e 01 dd f2 96 ae cb 
72 6e 83 ce 5f b0 b7 6b 03 a2 01 7d 2f 8c 0d 1c 81 c2 79 64 85 
a3 9f 46 9d 42 0a 96 5b 57 41 2d a9 ba b6 ea bb 0e 70 41 66 2c 
70 57 1b 07 a0 81 9b a2 f6 73 e0 9e c8 14 af e5

Alice: encrypted symmetric key: 
8e 7b 11 18 a8 96 90 82 e2 06 06 f2 40 9b 72 35 d1 86 82 77 d7 
50 08 8d c2 6f 7e 5f a1 95 1c bb 51 54 f8 ab 55 6e 60 f2 a1 5a 
59 06 76 90 ad 14 8a 7c a5 4e 50 48 3a 44 e3 b3 29 7e 0a 52 62 
8b b4 3f ac 69 88 da b7 21 cf fb 73 16 46 6a d9 ff 88 c1 9c 93 
ad 77 12 d7 05 3a 6d 05 d6 74 2e a6 78 85 29 ef 59 41 1f bf 07 
f2 8d 2a 2f ec e3 63 48 6c 9c da 66 22 00 c6 2d 6e 9f 80 2b 07 
89 46

Alice: entire secure message: 
8e 7b 11 18 a8 96 90 82 e2 06 06 f2 40 9b 72 35 d1 86 82 77 d7 
50 08 8d c2 6f 7e 5f a1 95 1c bb 51 54 f8 ab 55 6e 60 f2 a1 5a 
59 06 76 90 ad 14 8a 7c a5 4e 50 48 3a 44 e3 b3 29 7e 0a 52 62 
8b b4 3f ac 69 88 da b7 21 cf fb 73 16 46 6a d9 ff 88 c1 9c 93 
ad 77 12 d7 05 3a 6d 05 d6 74 2e a6 78 85 29 ef 59 41 1f bf 07 
f2 8d 2a 2f ec e3 63 48 6c 9c da 66 22 00 c6 2d 6e 9f 80 2b 07 
89 46 16 93 c4 b2 de bc f3 43 ea 11 af 0a bc e3 27 eb 2f 9a 03 
31 83 88 f0 95 ad 19 49 c9 17 c0 ea 3b 26 a6 51 59 65 39 04 2c 
fa d6 6e 97 56 49 b5 0b 82 5b 23 d4 53 fe eb 62 b5 59 23 9c 34 
29 55 27 14 9e f4 03 c2 67 a1 ae 49 f8 79 53 8b 98 27 9a e8 40 
cb 6f d4 cf d6 cc 42 73 52 fb 92 86 f1 52 50 8e a3 93 6f 92 5c 
b4 99 5b 48 15 e3 5d 0d 3b bf 1e da 37 b2 eb e5 7e 01 dd f2 96 
ae cb 72 6e 83 ce 5f b0 b7 6b 03 a2 01 7d 2f 8c 0d 1c 81 c2 79 
64 85 a3 9f 46 9d 42 0a 96 5b 57 41 2d a9 ba b6 ea bb 0e 70 41 
66 2c 70 57 1b 07 a0 81 9b a2 f6 73 e0 9e c8 14 af e5

Alice: Message sent!
Alice: closing socket
            \end{verbatim}
    }

    Output: Bob:
        {\footnotesize
            \singlespacing
            \begin{verbatim}
Bob: running on port 12345
Bob: received HELLO
Bob: sending public key hash encrypted
Bob: reading c private key and encrypting bob public key
Bob: c private key: 
-----BEGIN RSA PRIVATE KEY-----
MIICWwIBAAKBgQDEBEHn/Rbo5AdxmasncnGTDiXoZQfLvBHZqLdlvyebPWoAQCyw
VpFV6jNQWMqqcTa1s8753ruiv1KDLvtOhG1Kl8cbNcaxHAsXi+jZ0noBX8BSfWtx
1zhpRNp3SgCd98QjvLYLXvb854ZYXx+ZQVgfCodA4CbjXBGdqmIY3BPTlQIDAQAB
AoGAER+CFl7wimWpFM5kuixwKXV58EQrGywRrx7i7nt1XUVPJjh07u6RAZ1U4Dbx
dVQwgEz1zrQbVgs6jQUkpOZCmbNhk2oMqs4hw8cMgFtUac7Dy2qkm7mv8ITGOZ2I
qY1B1t6ZNOBszO7ZPAR3vaMEaItFDxa1ySh0Y1ah//HOcr0CQQDnwrEg5ineWH2l
xUsVEs7g523XvS8qbY853JEmvgyX55bw4YDfV3RLgh6x2gCyoT35PQCB2VDqhs7V
56tAwgD7AkEA2ISJCrkM6BXgBbIvGXvlCgWOdaeJW6XF2BJRHAxeOQfI63xiXCIL
SSZk+bPcff0O9fEG1DmicO+91kBzP+b4rwJAWjjvzbfsarOWTnds0EpfISzXFRqA
BwtZq5PTKfroWiZ9G08eZVPdYRvJqUEN7nxY7PMzhFk+Z96NHLawc2hTCwJAIXhj
gu/WSe5PwjGoTEU1w9XWDuQGPM+khOFX/oD+88v7SEPjJKDyo602wM8ID8XV0Tkg
OCBstw6ohv1Rk5hN6wJAQjxLZPwlORmnuq1geFwMLdcfCZjp4xfXnGLBpMXcmc79
UpFcYmwmpigFe5iTqp4B8M/fpUuqIKdscjKSjCqNkA==
-----END RSA PRIVATE KEY-----

Bob: public key: 
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC0fwevSA5UsKh2yWPMGFwBiAuG
V4bKldY9NGHI72SUG9abQ3eIJyBPrqo+yyM3R/8l8AO5L5grFUrUHawdqTON4BVT
8z29YTfQ7HWZlBYWxWGRBOyAuHX1N/k4IDldQXJXYEey/dnolo4c1Ks004XFFXx+
R+H1gDj0GDvxv6tM+QIDAQAB
-----END PUBLIC KEY-----

Bob: encrypted public key hash: 
8c ba 80 39 ff fb 40 62 8b ae 4e f5 39 cd 4b 2b 42 72 4b 8e d6 
a2 b0 71 e4 96 2d 6d 2e c1 a1 5d d4 71 b1 2d 55 69 3e 97 98 f1 
a0 4c cd c7 9e 41 d6 c3 c2 ee 9a ca 66 47 9a a6 cc a3 98 7e a9 
26 1b 40 69 cb cd d2 12 36 57 c4 31 98 35 f8 b0 37 32 ab 4d a3 
0c c5 8c 9a d1 06 e6 29 09 d7 a5 c8 ec 16 36 f0 6f 17 6c 1e 5e 
df 70 aa ed 61 18 b6 0e b9 32 ae c1 5f 62 2b df 26 b6 b0 bc 87 
1f f4
Bob: reading from socket
Bob: reading from socket
Bob: received secure message: 
8e 7b 11 18 a8 96 90 82 e2 06 06 f2 40 9b 72 35 d1 86 82 77 d7 
50 08 8d c2 6f 7e 5f a1 95 1c bb 51 54 f8 ab 55 6e 60 f2 a1 5a 
59 06 76 90 ad 14 8a 7c a5 4e 50 48 3a 44 e3 b3 29 7e 0a 52 62 
8b b4 3f ac 69 88 da b7 21 cf fb 73 16 46 6a d9 ff 88 c1 9c 93 
ad 77 12 d7 05 3a 6d 05 d6 74 2e a6 78 85 29 ef 59 41 1f bf 07 
f2 8d 2a 2f ec e3 63 48 6c 9c da 66 22 00 c6 2d 6e 9f 80 2b 07 
89 46 16 93 c4 b2 de bc f3 43 ea 11 af 0a bc e3 27 eb 2f 9a 03 
31 83 88 f0 95 ad 19 49 c9 17 c0 ea 3b 26 a6 51 59 65 39 04 2c 
fa d6 6e 97 56 49 b5 0b 82 5b 23 d4 53 fe eb 62 b5 59 23 9c 34 
29 55 27 14 9e f4 03 c2 67 a1 ae 49 f8 79 53 8b 98 27 9a e8 40 
cb 6f d4 cf d6 cc 42 73 52 fb 92 86 f1 52 50 8e a3 93 6f 92 5c 
b4 99 5b 48 15 e3 5d 0d 3b bf 1e da 37 b2 eb e5 7e 01 dd f2 96 
ae cb 72 6e 83 ce 5f b0 b7 6b 03 a2 01 7d 2f 8c 0d 1c 81 c2 79 
64 85 a3 9f 46 9d 42 0a 96 5b 57 41 2d a9 ba b6 ea bb 0e 70 41 
66 2c 70 57 1b 07 a0 81 9b a2 f6 73 e0 9e c8 14 af e5

Bob: bobs private key: 
-----BEGIN RSA PRIVATE KEY-----
MIICWwIBAAKBgQC0fwevSA5UsKh2yWPMGFwBiAuGV4bKldY9NGHI72SUG9abQ3eI
JyBPrqo+yyM3R/8l8AO5L5grFUrUHawdqTON4BVT8z29YTfQ7HWZlBYWxWGRBOyA
uHX1N/k4IDldQXJXYEey/dnolo4c1Ks004XFFXx+R+H1gDj0GDvxv6tM+QIDAQAB
AoGAVPTBqjgRPr2T3a13Araof7QIMKh78ljKaS6BpDFBtxDPV29PEM/Rvo+o5Dt7
DOcfajzpk72aMxUnjmWVALUGZUOpfpdRfB/98vw5f+Zxc+mefGdqM/QpAjzD5s7n
4tJ7em83atYe1hNSY0LzElDvh5qhi314xo6c6GhSr+8IOnECQQDY7cJTOpOPBsBg
aSzrekPEmmCP81mG1LW9pyQSb7F8z5wRS+3V5ln2dGo3fE5VjnFOwvGcLm63Zd01
hVIVg/+FAkEA1QFsp4n4Ep/qNmHJhFKKeA6AqvYv8kJDJ/n++/bJZp8wTWqLii5t
xKubN1wWGn7LyYD1GwFt4DlVTPcJ4L4/5QJAXR05c4ZKPnN0ci3TNUSnACYP2tpn
DGQTmtO6vRsqgVuQLzB7Z3xYE10HFsgJy9m3s0okcZjQt3JHEKkogcnGDQJAVLf2
UUSMyEuWSf7muZxiupF6F4VHWKGGOFY0Vl63h/t0qLXhvhntSrW+TGxx1iPsRb7m
vdD5tJ7ZEH2JDjxdCQJARhF5HaY3UmRfvIwC5sspw1zCXeCuxy3ekrGZa1lavqa+
UbTiH+Hvyx03XB+T/2jKMMJ1nSJQy5vMoC6vm3KBnw==
-----END RSA PRIVATE KEY-----

Bob: encrypted symmetric key: 
8e 7b 11 18 a8 96 90 82 e2 06 06 f2 40 9b 72 35 d1 86 82 77 d7 
50 08 8d c2 6f 7e 5f a1 95 1c bb 51 54 f8 ab 55 6e 60 f2 a1 5a 
59 06 76 90 ad 14 8a 7c a5 4e 50 48 3a 44 e3 b3 29 7e 0a 52 62 
8b b4 3f ac 69 88 da b7 21 cf fb 73 16 46 6a d9 ff 88 c1 9c 93 
ad 77 12 d7 05 3a 6d 05 d6 74 2e a6 78 85 29 ef 59 41 1f bf 07 
f2 8d 2a 2f ec e3 63 48 6c 9c da 66 22 00 c6 2d 6e 9f 80 2b 07 
89 46

Bob: decrypted symmetric key: 
bf 79 82 eb 9a 6a de 7d d0 ff 68 07 62 0b 20 55 90 77 12 fb ea 
41 5e 48

Bob: encrypted message: 
16 93 c4 b2 de bc f3 43 ea 11 af 0a bc e3 27 eb 2f 9a 03 31 83 
88 f0 95 ad 19 49 c9 17 c0 ea 3b 26 a6 51 59 65 39 04 2c fa d6 
6e 97 56 49 b5 0b 82 5b 23 d4 53 fe eb 62 b5 59 23 9c 34 29 55 
27 14 9e f4 03 c2 67 a1 ae 49 f8 79 53 8b 98 27 9a e8 40 cb 6f 
d4 cf d6 cc 42 73 52 fb 92 86 f1 52 50 8e a3 93 6f 92 5c b4 99 
5b 48 15 e3 5d 0d 3b bf 1e da 37 b2 eb e5 7e 01 dd f2 96 ae cb 
72 6e 83 ce 5f b0 b7 6b 03 a2 01 7d 2f 8c 0d 1c 81 c2 79 64 85 
a3 9f 46 9d 42 0a 96 5b 57 41 2d a9 ba b6 ea bb 0e 70 41 66 2c 
70 57 1b 07 a0 81 9b a2 f6 73 e0 9e c8 14 af e5

Bob: encrypted hash: 
2c 6a 3b 0d f6 a5 c7 28 05 36 a1 57 09 32 96 df 5d fe 63 e3 9f 
44 f1 99 32 6a e5 d4 7c 33 a6 09 04 d3 70 32 2a 99 fb dd 48 27 
3e f0 55 00 3a ba aa ef 0c 33 ab 9d f7 ea e7 d7 5c 5c a4 c6 a4 
6f 05 93 27 f9 da 4d 6f 89 cc 33 a1 b0 52 38 cd 8e 60 33 1b 87 
10 7d c7 3a eb 7b 47 35 84 7a e4 78 c3 20 d5 0c 75 85 71 90 ed 
b1 3a 28 ab e0 97 c3 cc 81 c7 3f e3 77 a4 71 66 a8 35 64 17 98 
6a d5

Bob: Message Received: 
This is a test message! Edit message.txt to change me.

Bob: decrypted hash: 
70 65 30 34 51 32 74 4f 36 65 72 53 4b 45 73 71 70 4d 77 30 46 
41 6f 6b 36 5a 34 3d

Bob: computed SHA1 hash of message: 
70 65 30 34 51 32 74 4f 36 65 72 53 4b 45 73 71 70 4d 77 30 46 
41 6f 6b 36 5a 34 3d

Bob: Hashes Matched! Message was authenticated and intact.
Bob: closing socket
            \end{verbatim}
    }
        
\end{itemize}
\end{document}
